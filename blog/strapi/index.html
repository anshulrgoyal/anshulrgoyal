<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.3">
<link rel="alternate" type="application/rss+xml" href="/anshulrgoyal/blog/rss.xml" title="Anshul Goyal Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/anshulrgoyal/blog/atom.xml" title="Anshul Goyal Blog Atom Feed"><title data-react-helmet="true">All in one guide for creating a killer API with Strapi | Anshul Goyal</title><meta data-react-helmet="true" property="og:title" content="All in one guide for creating a killer API with Strapi | Anshul Goyal"><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" name="description" content="This article was originally published here"><meta data-react-helmet="true" property="og:description" content="This article was originally published here"><meta data-react-helmet="true" property="og:url" content="https://anshulrgoyal.github.io/anshulrgoyal/blog/strapi"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_tag" content="default"><meta data-react-helmet="true" property="og:image" content="https://anshulrgoyal.github.io/anshulrgoyal/img/anshul.jpg"><meta data-react-helmet="true" name="twitter:image" content="https://anshulrgoyal.github.io/anshulrgoyal/img/anshul.jpg"><link data-react-helmet="true" rel="shortcut icon" href="/anshulrgoyal/img/anshul.jpg"><link data-react-helmet="true" rel="canonical" href="https://anshulrgoyal.github.io/anshulrgoyal/blog/strapi"><link data-react-helmet="true" rel="alternate" href="https://anshulrgoyal.github.io/anshulrgoyal/blog/strapi" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://anshulrgoyal.github.io/anshulrgoyal/blog/strapi" hreflang="x-default"><link rel="stylesheet" href="/anshulrgoyal/assets/css/styles.056d3a92.css">
<link rel="preload" href="/anshulrgoyal/assets/js/runtime~main.113fc30b.js" as="script">
<link rel="preload" href="/anshulrgoyal/assets/js/main.56fd1749.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();null!==e?t(e):window.matchMedia("(prefers-color-scheme: dark)").matches?t("dark"):window.matchMedia("(prefers-color-scheme: light)").matches?t("light"):t("dark")}(),document.documentElement.setAttribute("data-announcement-bar-initially-dismissed",function(){try{return"true"===localStorage.getItem("docusaurus.announcement.dismiss")}catch(t){}return!1}())</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_1oUP">Skip to main content</a></div><div class="announcementBar_3WsW" role="banner"><div class="announcementBarContent_3EUC announcementBarCloseable_3myR">I am looking for a JOB.</div><button type="button" class="announcementBarClose_38nx clean-btn" aria-label="Close"><span aria-hidden="true">×</span></button></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/anshulrgoyal/"><b class="navbar__title">Anshul Goyal</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/anshulrgoyal/blog">Blog</a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/anshulrgoyal/projects">Conributions</a><a href="https://github.com/anshulrgoyal" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="react-toggle displayOnlyInLargeViewport_GrZ2 react-toggle--checked react-toggle--disabled"><div class="react-toggle-track" role="button" tabindex="-1"><div class="react-toggle-track-check"><span class="toggle_71bT">🌜</span></div><div class="react-toggle-track-x"><span class="toggle_71bT">🌞</span></div><div class="react-toggle-thumb"></div></div><input type="checkbox" checked="" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/anshulrgoyal/"><b class="navbar__title">Anshul Goyal</b></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/anshulrgoyal/projects">Conributions</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link navbar__link--active" href="/anshulrgoyal/blog">Blog</a></li><li class="menu__list-item"><a href="https://github.com/anshulrgoyal" target="_blank" rel="noopener noreferrer" class="menu__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div></div></div></nav><div class="main-wrapper blog-wrapper blog-post-page"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_2ahu thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_2hhb margin-bottom--md">Recent posts</div><ul class="sidebarItemList_2xAf"><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/anshulrgoyal/blog/deno-plugin">How to create a Deno plugin in Rust</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/anshulrgoyal/blog/macro-rust">An intro to macros in rust</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/anshulrgoyal/blog/mlh-fellowship">MLH Fellowship: A new way of learning</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/anshulrgoyal/blog/easy-documentation-docusaurus">Easy Documentation using Docusaurus</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/anshulrgoyal/blog/rust-auth-lib">The state of Rust: Authorization/authentication libraries</a></li></ul></nav></aside><main class="col col--7"><article><header><h1 class="blogPostTitle_GeHD">All in one guide for creating a killer API with Strapi</h1><div class="blogPostData_291c margin-vert--md"><time datetime="2020-05-24T00:00:00.000Z">May 24, 2020</time> · 12 min read</div><div class="avatar margin-vert--md"><a href="https://github.com/anshulrgoyal" target="_blank" rel="noopener noreferrer" class="avatar__photo-link avatar__photo"><img src="/img/anshul.jpg" alt="Anshul Goyal"></a><div class="avatar__intro"><div class="avatar__name"><a href="https://github.com/anshulrgoyal" target="_blank" rel="noopener noreferrer">Anshul Goyal</a></div><small class="avatar__subtitle"></small></div></div></header><div class="markdown"><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="this-article-was-originally-published-here"></a>This article was originally published <a href="https://blog.logrocket.com/how-to-create-an-api-with-strapi/" target="_blank" rel="noopener noreferrer">here</a><a class="hash-link" href="#this-article-was-originally-published-here" title="Direct link to heading">#</a></h2><p>CMS has been around for quite some time. CMS refers to the content management system. Strapi is a headless CMS for Node.js. Strapi provides GUI for creating different content types and user management baked in the platform. Strapi supports both Restful API and GraphQL. Strapi supports both NoSQL and SQL databases. Changing the database is as simple as changing environment variables.</p><header><h1 class="h1Heading_27L5">Setting up the work environment</h1></header><p>Strapi requires Node.js installed on the system. Node.js can be downloaded from the official website. Strapi provides a boilerplate generator <code>create-strapi-app</code>, for setting up the application. It can be installed globally using npm using the following commands.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ npm i -g create-strapi-app</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Using <code>create-strapi-app</code> is simple just pass the name of the project. <code>--quickstart</code> will create a project with a default setting.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#F8F8F2"><span class="token plain">create-strapi-app my-blog --quickstart</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>An admin user is required to be created before Strapi can be used. Start the server using <code>npm run develop</code>.It starts the server on <code>http://localhost:1337</code>. Admin user is created using <code>http://localhost:1337/admin/auth/register</code>.</p><p><img src="https://paper-attachments.dropbox.com/s_CC88355492B2A98EAA40B097B1643DA8AE3D35CE509F7D881364ACA0FE320D6E_1590234211220_image.png" alt="Example for Admin User"></p><p>Once the boiler-plate is ready. Admin UI can be used to build database schema for API.</p><header><h1 class="h1Heading_27L5">Backend</h1></header><p>Strapi provides easy UI for the creation of database schema. For changing configuration, we have to edit out project files. For example, for changing the <code>env</code> variable we have to edit the <code>config/environments</code> folder.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="creating-database-schema"></a>Creating Database Schema<a class="hash-link" href="#creating-database-schema" title="Direct link to heading">#</a></h2><p>Strapi includes a content-builder plugin which provides a great UI for creating a database schema. The plugin is independent of the database. The same schema can be used in the SQL and NoSQL databases. The demo website would have a Blog Collection type and Comment Collection type. The blog would store most of the content of different articles. Comment collection will store comments on blog and user information.</p><p><strong>Creating a Collection</strong>
We will start by login into our admin at http://localhost:1337/admin. We now open the Content-Types builder page by clicking on <strong>Content-Types Builder</strong> from the sidebar.</p><p><img src="https://paper-attachments.dropbox.com/s_CC88355492B2A98EAA40B097B1643DA8AE3D35CE509F7D881364ACA0FE320D6E_1590245355602_image.png"></p><p>Now create a new collection named “Blog”. This would store blogs for the site. It would have the title, image, and content.</p><p><img src="https://paper-attachments.dropbox.com/s_CC88355492B2A98EAA40B097B1643DA8AE3D35CE509F7D881364ACA0FE320D6E_1590245980107_image.png"></p><p>Now we would create a collection named “Comment”. This would store comments for the blog. It would have content, user, blog. <code>blog</code> field store the link to the blog on which comment was created and user store details about the user who created it.</p><p><img src="https://paper-attachments.dropbox.com/s_CC88355492B2A98EAA40B097B1643DA8AE3D35CE509F7D881364ACA0FE320D6E_1590246246530_image.png"></p><p><img src="https://paper-attachments.dropbox.com/s_CC88355492B2A98EAA40B097B1643DA8AE3D35CE509F7D881364ACA0FE320D6E_1590246377435_image.png"></p><p>We have created links from comments, one to user collection, and other to blog collection. Blog collection and user collection don’t have information about the link. Now our backend is all set.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="documentation-plugin"></a>Documentation Plugin<a class="hash-link" href="#documentation-plugin" title="Direct link to heading">#</a></h2><p>We would install documentation-plugin from the “Marketplace” section for easy access to API details. This plugin would create the swagger specification for the API.</p><p><img src="https://paper-attachments.dropbox.com/s_CC88355492B2A98EAA40B097B1643DA8AE3D35CE509F7D881364ACA0FE320D6E_1590473880995_image.png"></p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="authentication"></a>Authentication<a class="hash-link" href="#authentication" title="Direct link to heading">#</a></h2><p>Authentication is a very important aspect of any application. Strapi has JWT based authentication out of the box. A default key is used for signing JWT. Signing key can be changed in the configuration file <code>/extensions/users-permissions/config/jwt.json</code>. API for user signup and login is already baked in the platform.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#F8F8F2"><span class="token plain">{</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  &quot;jwtSecret&quot;: &quot;f1b4e23e-480b-4e58-923e-b759a593c2e0&quot;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>We will use the <code>local</code> provider for authentication. This password and email/username are used for authenticating a user. If we open “Documentation” from the Sidebar, it will provide an option to see the swagger API documentation.</p><p><img src="https://paper-attachments.dropbox.com/s_CC88355492B2A98EAA40B097B1643DA8AE3D35CE509F7D881364ACA0FE320D6E_1590474793994_image.png"></p><p>We click on “Open the Documentation” to view swagger API Documentation. If we navigate to “UsersPermissions- User” we can see there are API to create a user and login user.</p><p><img src="https://paper-attachments.dropbox.com/s_CC88355492B2A98EAA40B097B1643DA8AE3D35CE509F7D881364ACA0FE320D6E_1590475203429_image.png"></p><p>We will use <code>/auth/local</code> and <code>/auth/local/register</code>.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="setting-up-permission"></a>Setting Up Permission<a class="hash-link" href="#setting-up-permission" title="Direct link to heading">#</a></h2><p>Strapi has two roles by default. These roles are used to control access to content.</p><ol><li>Public role is for an unauthenticated user</li><li>Authenticated is for an authenticated user.</li></ol><p>These roles are automatically assigned to a user based on authentication status. We would allow “Public” users to read blogs and comments and “Authenticated” users can comment on the blog and edit comments. Roles can be edited in the “Roles and Permission” section.</p><p><img src="https://paper-attachments.dropbox.com/s_CC88355492B2A98EAA40B097B1643DA8AE3D35CE509F7D881364ACA0FE320D6E_1590485724497_image.png"></p><p>Edit public Roles to allow access to Blogs and Comments</p><p><img src="https://paper-attachments.dropbox.com/s_CC88355492B2A98EAA40B097B1643DA8AE3D35CE509F7D881364ACA0FE320D6E_1590486276961_image.png"></p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="adding-comments"></a>Adding Comments<a class="hash-link" href="#adding-comments" title="Direct link to heading">#</a></h2><p>Now let us add comments to our demo website. For adding comments a user must be authenticated. We need to control write access to comment collection by customizing controller for “Comment” collection. The controller for every collection is located in the <code>api</code> folder. For changing controller edit file <code>api/comment/controllers/comment.js</code>.</p><p>We need to install <code>strapi-util</code>s for editing our controller.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#F8F8F2"><span class="token plain">npm i strapi-utils</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">// file: api/comment/controllers/comment.js</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">const { sanitizeEntity } = require(&#x27;strapi-utils&#x27;);</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">module.exports = {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    // this method is called when api to create comment is called</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    async create(ctx) {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        // add user from the request and add it to the body of request</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        ctx.request.body.user = ctx.state.user.id;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        // call the function to creating comment with data</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        let entity = await strapi.services.comment.create(ctx.request.body);</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        // return data for api after removing field which are not exported</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        return sanitizeEntity(entity, { model: strapi.models.comment });</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    },</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    async update(ctx) {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        // get the id of comment which is updated</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        const { id } = ctx.params;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        // finding the comment for user and id</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        const [comment] = await strapi.services.comment.find({</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            id: ctx.params.id,</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            &#x27;user.id&#x27;: ctx.state.user.id,</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        });</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        // comment does not exist send error</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        if (!comment) {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            return ctx.unauthorized(`You can&#x27;t update this entry`);</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        // update the comment</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        let entity = await strapi.services.comment.update({ id }, ctx.request.body);</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">         // return data for api after removing field which are not exported</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        return sanitizeEntity(entity, { model: strapi.models.comment });</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    },</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    async delete(ctx) {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        // get the id of comment which is updated</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        const { id } = ctx.params;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        // finding the comment for user and id</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        const [comment] = await strapi.services.comment.find({</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            id: ctx.params.id,</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            &#x27;user.id&#x27;: ctx.state.user.id,</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        });</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        // comment does not exist send error</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        if (!comment) {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            return ctx.unauthorized(`You can&#x27;t update this entry`);</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        // delete the comment</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        let entity = await strapi.services.comment.delete({ id });</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">         // return data for api after removing field which are not exported</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        return sanitizeEntity(entity, { model: strapi.models.comment });</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    },</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">};</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>We just add an extra layer over the function provided by strapi, so that we can add user data to the request body, and rest is handled by strapi. Now we need to change the “Authenticated” user role so that users can create, edit, and delete comments.</p><p><img src="https://paper-attachments.dropbox.com/s_CC88355492B2A98EAA40B097B1643DA8AE3D35CE509F7D881364ACA0FE320D6E_1590587444113_image.png"></p><p>We give a user permission to create, delete, edit comments.</p><header><h1 class="h1Heading_27L5">Frontend</h1></header><p>For the frontend, we will use Gatsbyjs. We would create a new gatsby project using <code>gatsby new frontend</code>. File structure for our project is:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#F8F8F2"><span class="token plain">src/</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">├── components</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">│   ├── card.js</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">│   └── dialog.js</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">├── images</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">└── pages</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    ├── 404.js</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    ├── blog.js</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    └── index.js</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>Different Compoments</strong></p><ul><li>card.js contains a simple card component that displays information provided to it as props.</li><li>dialog.js contains a dialog for sign in and signup.</li><li>blog.js is used to display blogs and comments.</li><li>index.js is the homepage, it display list of blogs</li><li>404.js shows URL not found.</li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="homepage"></a>Homepage<a class="hash-link" href="#homepage" title="Direct link to heading">#</a></h2><p><img src="https://paper-attachments.dropbox.com/s_CC88355492B2A98EAA40B097B1643DA8AE3D35CE509F7D881364ACA0FE320D6E_1590834989946_image.png"></p><p>We make a GET request to API <code>/blogs</code> to fetch all the blogs. Then it maps over a list of blogs and displays Card component for each blog. It also contains code for displaying login/register dialog. When the user clicks on a Card it navigates them to <code>/blog</code> page.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#F8F8F2"><span class="token plain">import React, { useState } from &#x27;react&#x27;;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import { makeStyles } from &#x27;@material-ui/core/styles&#x27;;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import Grid from &#x27;@material-ui/core/Grid&#x27;;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import Typography from &#x27;@material-ui/core/Typography&#x27;;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import Card from &quot;../components/card&quot;;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import Dialog from &quot;../components/dialog&quot;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import { Button } from &#x27;@material-ui/core&#x27;;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">const useStyles = makeStyles((theme) =&gt; ({</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  root: {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    flexGrow: 1,</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    textAlign: &quot;center&quot;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  },</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  paper: {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    height: 500,</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    width: 400,</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  },</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  control: {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    padding: theme.spacing(2),</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  },</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}));</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">export default function () {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  const classes = useStyles();</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  const [blogs, setBlogs] = useState([])</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  const [open, setOpen] = useState(false)</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  const [login, setLogin] = useState(false)</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  // fetch all blogs</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  React.useEffect(() =&gt; {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    fetch(&quot;http://localhost:1337/blogs&quot;).then(res =&gt; res.json()).then(val =&gt; setBlogs(val))</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  }, [])</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  return (</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    &lt;&gt;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    {/*dialog for authentication */}</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      &lt;Dialog open={open} setOpen={setOpen} login={login} /&gt;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      &lt;Grid container className={classes.root} spacing={2}&gt;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        &lt;Grid item xs={12}&gt;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          &lt;Grid container justify=&quot;center&quot;&gt;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            &lt;Grid item xs={10}&gt;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">              &lt;Typography variant=&quot;h3&quot; component=&quot;h2&quot; gutterBottom gutterLeft&gt;Blogs&lt;/Typography&gt;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            &lt;/Grid&gt;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            {/*check if token is present or not */}</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">              !localStorage.getItem(&quot;token&quot;) ? [&lt;Grid item xs={1}&gt;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                &lt;Button onClick={() =&gt; { setOpen(true); setLogin(true) }}&gt;Login&lt;/Button&gt;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">              &lt;/Grid&gt;,</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">              &lt;Grid item xs={1}&gt;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                &lt;Button onClick={() =&gt; { setOpen(true); setLogin(false) }}&gt; Register&lt;/Button&gt;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">              &lt;/Grid&gt;] : &quot;&quot;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            }</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          &lt;/Grid&gt;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        &lt;/Grid&gt;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        &lt;Grid item xs={12}&gt;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          &lt;Grid container justify=&quot;center&quot; spacing={10}&gt;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            {/*map through list of blog and create list of cards */}</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            {blogs.map((value) =&gt; (</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">              &lt;Grid key={value} item&gt;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                &lt;Card value={value} /&gt;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">              &lt;/Grid&gt;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            ))}</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          &lt;/Grid&gt;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        &lt;/Grid&gt;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      &lt;/Grid&gt;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    &lt;/&gt;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  );</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Card Component</p><p><img src="https://paper-attachments.dropbox.com/s_CC88355492B2A98EAA40B097B1643DA8AE3D35CE509F7D881364ACA0FE320D6E_1590834819604_image.png"></p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#F8F8F2"><span class="token plain">import React from &#x27;react&#x27;;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import { makeStyles } from &#x27;@material-ui/core/styles&#x27;;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import Card from &#x27;@material-ui/core/Card&#x27;;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import CardHeader from &#x27;@material-ui/core/CardHeader&#x27;;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import CardMedia from &#x27;@material-ui/core/CardMedia&#x27;;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import CardContent from &#x27;@material-ui/core/CardContent&#x27;;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import CardActions from &#x27;@material-ui/core/CardActions&#x27;;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import Collapse from &#x27;@material-ui/core/Collapse&#x27;;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import Typography from &#x27;@material-ui/core/Typography&#x27;;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import { red } from &#x27;@material-ui/core/colors&#x27;;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import { Link } from &#x27;gatsby&#x27;;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">const useStyles = makeStyles((theme) =&gt; ({</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  root: {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    maxWidth: 345,</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  },</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  media: {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    height: 0,</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    paddingTop: &#x27;56.25%&#x27;, // 16:9</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  },</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  expand: {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    transform: &#x27;rotate(0deg)&#x27;,</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    marginLeft: &#x27;auto&#x27;,</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    transition: theme.transitions.create(&#x27;transform&#x27;, {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      duration: theme.transitions.duration.shortest,</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }),</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  },</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  expandOpen: {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    transform: &#x27;rotate(180deg)&#x27;,</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  },</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  avatar: {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    backgroundColor: red[500],</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  },</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}));</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">export default function NewCard({ value }) {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  const classes = useStyles();</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  return (</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    &lt;Link to={`/blog`} state={{ value }}&gt;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      &lt;Card className={classes.root}&gt;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        &lt;CardHeader</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          subheader={`Published On ${new Date(value.created_at).toLocaleDateString(&quot;in&quot;)}`}</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        /&gt;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        &lt;CardMedia</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          className={classes.media}</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          image={&quot;http://localhost:1337&quot; + value.image.url}</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        /&gt;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        &lt;CardContent&gt;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          &lt;Typography variant=&quot;body2&quot; color=&quot;textSecondary&quot; component=&quot;p&quot;&gt;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            {value.title}</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          &lt;/Typography&gt;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        &lt;/CardContent&gt;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      &lt;/Card&gt;&lt;/Link&gt;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  );</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Dialog Component</p><p><img src="https://paper-attachments.dropbox.com/s_CC88355492B2A98EAA40B097B1643DA8AE3D35CE509F7D881364ACA0FE320D6E_1590834887038_image.png"></p><p>We make a POST request to <code>/auth/local/register</code> for user signup with a username, email, and password. When a register is successful, a JWT token is returned which is saved in local storage and can be used later. For log in we make a POST request to <code>/auth/local</code> with two fields <code>identifier</code> and <code>password</code>. <code>identifier</code> can be email or username.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#F8F8F2"><span class="token plain">import React, { useState } from &#x27;react&#x27;;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import Button from &#x27;@material-ui/core/Button&#x27;;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import TextField from &#x27;@material-ui/core/TextField&#x27;;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import Dialog from &#x27;@material-ui/core/Dialog&#x27;;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import DialogActions from &#x27;@material-ui/core/DialogActions&#x27;;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import DialogContent from &#x27;@material-ui/core/DialogContent&#x27;;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import DialogContentText from &#x27;@material-ui/core/DialogContentText&#x27;;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import DialogTitle from &#x27;@material-ui/core/DialogTitle&#x27;;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">export default function FormDialog({ open, setOpen, login }) {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    const [pass, setPass] = useState(&quot;&quot;)</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    const [email, setEmail] = useState(&quot;&quot;)</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    const [user, setUser] = useState(&quot;&quot;)</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    const handleSubmit = () =&gt; {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        if (!login)</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            fetch(&quot;http://localhost:1337/auth/local/register&quot;, {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                method: &quot;post&quot;,</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                headers: {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                    &quot;content-type&quot;: &quot;application/json&quot;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                },</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                body: JSON.stringify({</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                    password: pass,</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                    email,</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                    username: user</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                })</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            }).then((res) =&gt; res.json())</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                .then(res =&gt; localStorage.setItem(&quot;token&quot;, res.jwt)).finally(() =&gt; setOpen(false))</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        else</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            fetch(&quot;http://localhost:1337/auth/local&quot;, {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                method: &quot;post&quot;,</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                headers: {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                    &quot;content-type&quot;: &quot;application/json&quot;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                },</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                body: JSON.stringify({</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                    password: pass,</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                    identifier: user || email</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                })</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            }).then((res) =&gt; res.json())</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                .then(res =&gt; localStorage.setItem(&quot;token&quot;, res.jwt)).finally(() =&gt; setOpen(false))</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    };</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    const handleClose = () =&gt; {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        setOpen(false);</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    };</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    return (</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        &lt;div&gt;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            &lt;Dialog open={open} onClose={handleClose} aria-labelledby=&quot;form-dialog-title&quot;&gt;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                &lt;DialogTitle id=&quot;form-dialog-title&quot;&gt;{login ? &quot;Login&quot; : &quot;Register&quot;}&lt;/DialogTitle&gt;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                &lt;DialogContent&gt;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                    &lt;DialogContentText&gt;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                        Please provide details</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          &lt;/DialogContentText&gt;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                    &lt;TextField</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                        autoFocus</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                        margin=&quot;dense&quot;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                        id=&quot;email&quot;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                        label=&quot;Email Address&quot;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                        type=&quot;email&quot;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                        fullWidth</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                        value={email}</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                        onChange={(e) =&gt; { setEmail(e.target.value) }}</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                    /&gt;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                    &lt;TextField</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                        autoFocus</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                        margin=&quot;dense&quot;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                        id=&quot;username&quot;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                        label=&quot;Username&quot;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                        type=&quot;email&quot;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                        fullWidth</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                        value={user}</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                        onChange={(e) =&gt; { setUser(e.target.value) }}</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                    /&gt;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                    &lt;TextField</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                        autoFocus</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                        margin=&quot;dense&quot;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                        id=&quot;password&quot;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                        label=&quot;Password&quot;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                        type=&quot;password&quot;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                        fullWidth</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                        value={pass}</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                        onChange={(e) =&gt; { setPass(e.target.value) }}</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                    /&gt;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                &lt;/DialogContent&gt;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                &lt;DialogActions&gt;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                    &lt;Button onClick={handleClose} color=&quot;primary&quot;&gt;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                        Cancel</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          &lt;/Button&gt;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                    &lt;Button onClick={handleSubmit} color=&quot;primary&quot;&gt;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                        Submit</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          &lt;/Button&gt;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                &lt;/DialogActions&gt;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            &lt;/Dialog&gt;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        &lt;/div&gt;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    );</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="blog-page"></a>Blog Page<a class="hash-link" href="#blog-page" title="Direct link to heading">#</a></h2><p><img src="https://paper-attachments.dropbox.com/s_CC88355492B2A98EAA40B097B1643DA8AE3D35CE509F7D881364ACA0FE320D6E_1590834917875_image.png"></p><p>We will take the details of the blog from the location prop passed to the page. We will fetch comments for the blog using a GET request to <code>/comments?blog={{blog-id}}</code> <code>blog-id</code> is the id of the current blog. We make a POST request to <code>/comments</code> with JWT token in the header. This token is saved in the local storage.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#F8F8F2"><span class="token plain">import React, { useState, useEffect } from &#x27;react&#x27;;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import { makeStyles } from &#x27;@material-ui/core/styles&#x27;;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import Grid from &#x27;@material-ui/core/Grid&#x27;;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import Typography from &#x27;@material-ui/core/Typography&#x27;;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import List from &#x27;@material-ui/core/List&#x27;;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import ListItem from &#x27;@material-ui/core/ListItem&#x27;;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import ListItemIcon from &#x27;@material-ui/core/ListItemIcon&#x27;;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import ListItemText from &#x27;@material-ui/core/ListItemText&#x27;;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import Avatar from &#x27;@material-ui/core/Avatar&#x27;;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import { TextareaAutosize } from &#x27;@material-ui/core&#x27;;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import Button from &quot;@material-ui/core/Button&quot;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">const useStyles = makeStyles((theme) =&gt; ({</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    root: {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        flexGrow: 1,</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        textAlign: &quot;center&quot;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    },</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    paper: {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        height: 500,</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        width: 400,</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    },</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    control: {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        padding: theme.spacing(2),</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    },</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    content: {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        margin: &quot;100px&quot;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}));</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">export default function ({ location }) {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    const classes = useStyles();</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    const [comments, setComments] = useState([])</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    const [content, setContent] = useState(&quot;&quot;)</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    useEffect(() =&gt; {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        fetch(`http://localhost:1337/comments?blog=${location.state.value.id}`).then(res =&gt; res.json()).then(val =&gt; setComments(val))</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }, [])</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    const submitComment = () =&gt; {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        fetch(&quot;http://localhost:1337/comments&quot;, {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            method: &quot;post&quot;,</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            headers: {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                &quot;content-type&quot;: &quot;application/json&quot;,</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                authorization: `Bearer ${localStorage.getItem(&quot;token&quot;)}`</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            },</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            body: JSON.stringify({</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                content,</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                blog: location.state.value.id</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            })</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        }).then(() =&gt; fetch(`http://localhost:1337/comments?blog=${location.state.value.id}`).then(res =&gt; res.json()).then(val =&gt; setComments(val)))</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    return (</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        &lt;&gt;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            &lt;Grid container className={classes.root} spacing={2}&gt;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                &lt;Grid item xs={12}&gt;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                    &lt;Grid container justify=&quot;center&quot;&gt;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                        &lt;Grid item xs={10}&gt;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                            &lt;Typography variant=&quot;h3&quot; component=&quot;h2&quot; gutterBottom gutterLeft&gt;{location.state.value.title}&lt;/Typography&gt;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                        &lt;/Grid&gt;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                    &lt;/Grid&gt;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                &lt;/Grid&gt;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                &lt;Grid container justify=&quot;center&quot;&gt;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                    &lt;img src={&quot;http://localhost:1337&quot; + location.state.value.image.url}&gt;&lt;/img&gt;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                &lt;/Grid&gt;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                &lt;Grid item xs={12} className={classes.content}&gt;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                    &lt;Grid container justify=&quot;center&quot; spacing={10}&gt;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                        {location.state.value.content}</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                    &lt;/Grid&gt;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                &lt;/Grid&gt;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                &lt;Typography variant=&quot;h4&quot; component=&quot;h2&quot; gutterBottom gutterLeft&gt;Comments&lt;/Typography&gt;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                &lt;Grid item xs={12}&gt;&lt;TextareaAutosize minLength={10} rowsMin={10} style={{ width: &quot;100%&quot; }} value={content} onChange={(e) =&gt; setContent(e.target.value)} /&gt;&lt;/Grid&gt;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                &lt;Grid item xs={12}&gt;&lt;Button onClick={submitComment}&gt;Submit comment&lt;/Button&gt;&lt;/Grid&gt;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                &lt;Grid item xs={12}&gt;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                    &lt;Grid container justify=&quot;left&quot;&gt;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                        &lt;List&gt;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                            {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                                comments.map((val) =&gt; &lt;ListItem&gt;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                                    &lt;ListItemIcon&gt;&lt;Avatar&gt;{val.user.username[0]}&lt;/Avatar&gt;&lt;/ListItemIcon&gt;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                                    &lt;ListItemText primary={`${val.user.username} said  `} /&gt;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                                    &lt;ListItemText secondary={&quot;: &quot; + val.content} /&gt;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                                &lt;/ListItem&gt;)</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                            }</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                        &lt;/List&gt;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                    &lt;/Grid&gt;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                &lt;/Grid&gt;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            &lt;/Grid&gt;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        &lt;/&gt;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    );</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><header><h1 class="h1Heading_27L5">Database</h1></header><p>Strapi support both NoSQL and SQL database. Changing the database is as simple as changing the env variable in the configuration folder. By default, Strapi uses SQLite which is good for local testing but in production one should use a production-ready database like PostgresSQL or MySQL. We will use PostgreSQL. For changing the database we will edit <code>config/environments/production/database.json</code> file.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#F8F8F2"><span class="token plain">{</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  &quot;defaultConnection&quot;: &quot;default&quot;,</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  &quot;connections&quot;: {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    &quot;default&quot;: {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      &quot;connector&quot;: &quot;bookshelf&quot;,</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      &quot;settings&quot;: {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        &quot;client&quot;: &quot;postgres&quot;,</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        &quot;host&quot;: &quot;${process.env.DATABASE_HOST }&quot;,</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        &quot;port&quot;: &quot;${process.env.DATABASE_PORT }&quot;,</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        &quot;database&quot;: &quot;${process.env.DATABASE_NAME }&quot;,</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        &quot;username&quot;: &quot;${process.env.DATABASE_USERNAME }&quot;,</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        &quot;password&quot;: &quot;${process.env.DATABASE_PASSWORD }&quot;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      },</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      &quot;options&quot;: {}</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  }</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Now it will pick database credentials from the environment variable in production.</p><header><h1 class="h1Heading_27L5">Conclusion</h1></header><p>We have gone through some of basic of Strapi. Strapi is great for creating a backend API. It is very customizable and supports a wide array of integration. Strapi can be used with Nuxtjs, Reactjs, Angular any frontend framework. We learned how to create database schema with relations, authentication, customizing controllers, and filtering data.</p></div><footer class="row docusaurus-mt-lg blogPostDetailsFull_3kfx"><div class="col"><b>Tags:</b><a class="margin-horiz--sm" href="/anshulrgoyal/blog/tags/strapi">strapi</a><a class="margin-horiz--sm" href="/anshulrgoyal/blog/tags/nodejs">nodejs</a><a class="margin-horiz--sm" href="/anshulrgoyal/blog/tags/cms">cms</a><a class="margin-horiz--sm" href="/anshulrgoyal/blog/tags/backend">backend</a></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Blog post page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/anshulrgoyal/blog/auth-table"><div class="pagination-nav__sublabel">Newer Post</div><div class="pagination-nav__label">« Rust Auth Libraries</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/anshulrgoyal/blog/grpc-rust"><div class="pagination-nav__sublabel">Older Post</div><div class="pagination-nav__label">A beginners guide to gRPC with Rust »</div></a></div></nav></main><div class="col col--2"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#this-article-was-originally-published-here" class="table-of-contents__link">This article was originally published here</a></li><li><a href="#creating-database-schema" class="table-of-contents__link">Creating Database Schema</a></li><li><a href="#documentation-plugin" class="table-of-contents__link">Documentation Plugin</a></li><li><a href="#authentication" class="table-of-contents__link">Authentication</a></li><li><a href="#setting-up-permission" class="table-of-contents__link">Setting Up Permission</a></li><li><a href="#adding-comments" class="table-of-contents__link">Adding Comments</a></li><li><a href="#homepage" class="table-of-contents__link">Homepage</a></li><li><a href="#blog-page" class="table-of-contents__link">Blog Page</a></li></ul></div></div></div></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">About</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/anshulrgoyal/projects">Contributions</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items"><li class="footer__item"><a href="https://dev.to/anshulgoyal15/" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Dev.to<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://medium.com/@ar_goyal" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Medium<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://www.linkedin.com/in/anshul-goyal-8aa479135/" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Linkedin<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://twitter.com/ar_goyal" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/anshulrgoyal/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/anshulrgoyal" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2021 Anshul Goyal. Built with Docusaurus.</div></div></div></footer></div>
<script src="/anshulrgoyal/assets/js/runtime~main.113fc30b.js"></script>
<script src="/anshulrgoyal/assets/js/main.56fd1749.js"></script>
</body>
</html>